export async function initNavigation(){return(new NavigationController).init()}export class NavigationController{constructor(){this.elements={header:null,mobileMenuToggle:null,navMenu:null,navBackdrop:null,dropdownToggles:null,anchorLinks:null},this.config={SCROLL_THRESHOLD:100,MOBILE_BREAKPOINT:992,SCROLL_THROTTLE_DELAY:16,TRANSITION_DURATION:300},this.state={isScrolling:!1,isMobileMenuOpen:!1,currentScrollY:0,isInitialized:!1},this.handleScroll=this.throttle(this.handleScroll.bind(this),this.config.SCROLL_THROTTLE_DELAY),this.handleResize=this.debounce(this.handleResize.bind(this),250)}async init(){try{if("loading"===document.readyState&&await new Promise(e=>{document.addEventListener("DOMContentLoaded",e)}),this.cacheElements(),!this.validateElements())throw new Error("Essential navigation elements not found");this.attachEventListeners(),this.initializeScrollState(),this.state.isInitialized=!0,console.log("Navigation initialized successfully")}catch(e){console.error("Navigation initialization failed:",e),this.initializeFallback()}}cacheElements(){this.elements={header:document.querySelector("header"),mobileMenuToggle:document.querySelector(".mobile-toggle"),navMenu:document.querySelector(".nav-menu")||document.querySelector(".nav-links"),navBackdrop:document.querySelector(".nav-backdrop"),dropdownToggles:document.querySelectorAll(".dropbtn"),anchorLinks:document.querySelectorAll('a[href^="#"]:not([href="#"])')}}validateElements(){return!!this.elements.header}attachEventListeners(){window.addEventListener("scroll",this.handleScroll,{passive:!0}),window.addEventListener("resize",this.handleResize,{passive:!0}),this.elements.mobileMenuToggle&&this.elements.navMenu&&this.elements.mobileMenuToggle.addEventListener("click",this.toggleMobileMenu.bind(this)),this.elements.navBackdrop&&this.elements.navBackdrop.addEventListener("click",this.closeMobileMenu.bind(this)),this.elements.dropdownToggles.length>0&&this.elements.dropdownToggles.forEach(e=>{e.addEventListener("click",this.handleDropdownToggle.bind(this))}),this.elements.anchorLinks.length>0&&this.elements.anchorLinks.forEach(e=>{e.addEventListener("click",this.handleSmoothScroll.bind(this))}),document.addEventListener("keydown",e=>{"Escape"===e.key&&this.state.isMobileMenuOpen&&this.closeMobileMenu()})}initializeScrollState(){this.state.currentScrollY=window.scrollY,this.updateHeaderStyle()}handleScroll(){this.state.isScrolling||(this.state.isScrolling=!0,requestAnimationFrame(()=>{const e=window.scrollY;Math.abs(e-this.state.currentScrollY)>5&&(this.state.currentScrollY=e,this.updateHeaderStyle()),this.state.isScrolling=!1}))}updateHeaderStyle(){if(!this.elements.header)return;const e=this.state.currentScrollY>this.config.SCROLL_THRESHOLD;this.elements.header.classList.toggle("scrolled",e)}handleResize(){const e=window.innerWidth>=this.config.MOBILE_BREAKPOINT;e&&this.state.isMobileMenuOpen&&this.closeMobileMenu(),e&&this.closeAllDropdowns()}toggleMobileMenu(e){e&&e.preventDefault(),this.state.isMobileMenuOpen=!this.state.isMobileMenuOpen,this.elements.mobileMenuToggle&&this.elements.mobileMenuToggle.setAttribute("aria-expanded",this.state.isMobileMenuOpen),this.elements.navMenu&&this.elements.navMenu.classList.toggle("active",this.state.isMobileMenuOpen),this.elements.navBackdrop&&this.elements.navBackdrop.classList.toggle("active",this.state.isMobileMenuOpen),document.body.classList.toggle("menu-open",this.state.isMobileMenuOpen),this.state.isMobileMenuOpen?this.trapFocus():this.releaseFocus()}closeMobileMenu(){this.state.isMobileMenuOpen&&(this.state.isMobileMenuOpen=!1,this.elements.mobileMenuToggle&&this.elements.mobileMenuToggle.setAttribute("aria-expanded","false"),this.elements.navMenu&&this.elements.navMenu.classList.remove("active"),this.elements.navBackdrop&&this.elements.navBackdrop.classList.remove("active"),document.body.classList.remove("menu-open"),this.closeAllDropdowns(),this.releaseFocus())}handleDropdownToggle(e){const t=e.currentTarget;if(window.innerWidth>=this.config.MOBILE_BREAKPOINT)return;e.preventDefault(),e.stopPropagation();const n="true"===t.getAttribute("aria-expanded"),s=t.nextElementSibling;this.closeAllDropdowns(t),s&&s.classList.contains("dropdown-menu")&&(t.setAttribute("aria-expanded",!n),s.classList.toggle("show",!n))}closeAllDropdowns(e=null){this.elements.dropdownToggles.forEach(t=>{if(t===e)return;t.setAttribute("aria-expanded","false");const n=t.nextElementSibling;n&&n.classList.contains("dropdown-menu")&&n.classList.remove("show")})}handleSmoothScroll(e){const t=e.currentTarget.getAttribute("href"),n=document.querySelector(t);if(!n)return;e.preventDefault(),this.state.isMobileMenuOpen&&this.closeMobileMenu();const s=this.elements.header?this.elements.header.offsetHeight:0,i=n.getBoundingClientRect().top+window.scrollY-s-20;"scrollBehavior"in document.documentElement.style?window.scrollTo({top:i,behavior:"smooth"}):this.animateScroll(window.scrollY,i,800)}animateScroll(e,t,n){const s=performance.now(),i=t-e,o=t=>{const l=t-s,a=Math.min(l/n,1),r=1-Math.pow(1-a,3);window.scrollTo(0,e+i*r),a<1&&requestAnimationFrame(o)};requestAnimationFrame(o)}trapFocus(){if(!this.elements.navMenu)return;const e=this.elements.navMenu.querySelectorAll('a, button, [tabindex]:not([tabindex="-1"])');if(0===e.length)return;const t=e[0],n=e[e.length-1];t.focus(),this.focusTrapHandler=e=>{"Tab"===e.key&&(e.shiftKey?document.activeElement===t&&(n.focus(),e.preventDefault()):document.activeElement===n&&(t.focus(),e.preventDefault()))},document.addEventListener("keydown",this.focusTrapHandler)}releaseFocus(){this.focusTrapHandler&&(document.removeEventListener("keydown",this.focusTrapHandler),this.focusTrapHandler=null)}throttle(e,t){let n,s=0;return function(...i){const o=Date.now();o-s>t?(e.apply(this,i),s=o):(clearTimeout(n),n=setTimeout(()=>{e.apply(this,i),s=Date.now()},t-(o-s)))}}debounce(e,t){let n;return function(...s){clearTimeout(n),n=setTimeout(()=>e.apply(this,s),t)}}initializeFallback(){console.warn("Initializing navigation fallback mode"),this.elements.header&&window.addEventListener("scroll",()=>{const e=window.scrollY>this.config.SCROLL_THRESHOLD;this.elements.header.classList.toggle("scrolled",e)},{passive:!0})}destroy(){window.removeEventListener("scroll",this.handleScroll),window.removeEventListener("resize",this.handleResize),this.elements.mobileMenuToggle&&this.elements.mobileMenuToggle.removeEventListener("click",this.toggleMobileMenu),this.elements.navBackdrop&&this.elements.navBackdrop.removeEventListener("click",this.closeMobileMenu),this.elements.dropdownToggles?.forEach(e=>{e.removeEventListener("click",this.handleDropdownToggle)}),this.elements.anchorLinks?.forEach(e=>{e.removeEventListener("click",this.handleSmoothScroll)}),this.releaseFocus(),console.log("Navigation destroyed")}}
//# sourceMappingURL=navigation.min.js.map