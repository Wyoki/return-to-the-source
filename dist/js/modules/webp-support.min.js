let webpSupportCache=null;export function initWebPSupport(){return checkWebPSupport().then(e=>(document.documentElement.classList.toggle("webp",e),updateImageSources(e),setupLazyLoading(e),e))}function checkWebPSupport(){return null!==webpSupportCache?Promise.resolve(webpSupportCache):new Promise(e=>{const a=new Image;a.onload=a.onerror=()=>{webpSupportCache=2===a.width,e(webpSupportCache)},a.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"})}function updateImageSources(e){e||(document.querySelectorAll('picture source[type="image/webp"]').forEach(e=>{const a=e.dataset.fallback;if(a){const t=e.parentElement.querySelector("img");t&&(t.src=a)}}),document.querySelectorAll("img[data-fallback]").forEach(e=>{e.src.endsWith(".webp")&&(e.src=e.dataset.fallback)}))}function setupLazyLoading(e){const a=document.querySelectorAll('img[loading="lazy"]');if(0===a.length)return;const t=new IntersectionObserver((a,t)=>{a.forEach(a=>{if(a.isIntersecting){const o=a.target;let r;if(e&&o.dataset.src)r=o.dataset.src;else if(o.dataset.fallback)r=o.dataset.fallback;else{if(!o.dataset.src)return void t.unobserve(o);r=o.dataset.src}o.classList.add("lazy-loading"),"requestIdleCallback"in window?requestIdleCallback(()=>{loadImage(o,r,t)}):setTimeout(()=>{loadImage(o,r,t)},0)}})},{rootMargin:"200px 0px"});a.forEach(e=>t.observe(e))}function loadImage(e,a,t){e.parentNode?(e.src=a,e.onload=()=>{e.classList.remove("lazy-loading"),e.classList.add("lazy-loaded"),t.unobserve(e)},e.onerror=()=>{console.error("Failed to load image:",a),e.classList.remove("lazy-loading"),e.dataset.fallback&&a!==e.dataset.fallback?e.src=e.dataset.fallback:t.unobserve(e)}):t.unobserve(e)}
//# sourceMappingURL=webp-support.min.js.map